arc.set = matrix(c("accel_mean","sitting",
"pitch4_var", "sitting",
"accel4_module","sitting",
"roll2_var","sittingdown",
"pitch2_var","sittingdown",
"accel_mean","sittingdown",
"roll1_var","walking",
"pitch1_var","walking",
"accel1_module","walking",
"roll2_var","walking",
"roll1_var","standing",
"pitch1_var","standing",
"accel1_module","standing",
"roll3_var","standing",
"roll2_var","standingup",
"pitch4_var","standingup",
"pitch2_var","standingup"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set
arcs(e) = arc.set
e
data <- read.csv(file="../measure_for_r.csv", header=TRUE, sep=";")
data$sitting <- factor(data$sitting)
data$sittingdown <- factor(data$sittingdown)
data$walking <- factor(data$walking)
data$standing <- factor(data$standing)
data$standingup <- factor(data$standingup)
plot.network(e)
plot.network <- function(structure, ht = "400px"){
nodes.uniq <- unique(c(structure$arcs[,1], structure$arcs[,2]))
nodes <- data.frame(id = nodes.uniq,
label = nodes.uniq,
color = "darkturquoise",
shadow = TRUE)
edges <- data.frame(from = structure$arcs[,1],
to = structure$arcs[,2],
arrows = "to",
smooth = TRUE,
shadow = TRUE,
color = "black")
return(visNetwork(nodes, edges, height = ht, width = "100%"))
}
fit = bn.fit(e, data, method = "mle", debug = TRUE)
bn.net(fit, debug = FALSE)
nodi <- c("roll1_var","pitch1_var","accel1_module","roll2_var","pitch2_var","accel2_module","roll3_var","pitch3_var","accel3_module","roll4_var","pitch4_var","accel4_module","accel_mean","accel_std","sitting","sittingdown","walking","standing","standingup")
e = empty.graph(nodi)
class(e)
e
arc.set = matrix(c("accel1_module","sitting",
"accel_mean", "sitting",
"roll2_var","sitting",
"pitch4_var","sittingdown",
"roll2_var","standing",
"roll1_var","standing",
"pitch4_var","standingup",
"pitch2_var","standingup",
"roll3_var","standingup",
"pitch3_var","standingup",
"pitch3_var","walking",
"accel_mean","walking",
"pitch1_var","walking"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set
arcs(e) = arc.set
e
plot.network(e)
data$sitting <- factor(data$sitting)
data$sittingdown <- factor(data$sittingdown)
data$walking <- factor(data$walking)
data$standing <- factor(data$standing)
data$standingup <- factor(data$standingup)
plot.network(e)
plot.network <- function(structure, ht = "400px"){
nodes.uniq <- unique(c(structure$arcs[,1], structure$arcs[,2]))
nodes <- data.frame(id = nodes.uniq,
label = nodes.uniq,
color = "darkturquoise",
shadow = TRUE)
edges <- data.frame(from = structure$arcs[,1],
to = structure$arcs[,2],
arrows = "to",
smooth = TRUE,
shadow = TRUE,
color = "black")
return(visNetwork(nodes, edges, height = ht, width = "100%"))
}
fit = bn.fit(e, data, method = "mle", debug = TRUE)
structure <- hc(data, score = "bic-cg")
fit = bn.fit(structure, data)
plot.network(structure)
e = empty.graph(nodi)
class(e)
e
arc.set = matrix(c("accel1_module","sitting",
"accel_mean", "sitting"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set
arcs(e) = arc.set
e
data <- read.csv(file="../measure_for_r.csv", header=TRUE, sep=";")
data$sitting <- factor(data$sitting)
data$sittingdown <- factor(data$sittingdown)
data$walking <- factor(data$walking)
data$standing <- factor(data$standing)
data$standingup <- factor(data$standingup)
plot.network(e)
plot.network <- function(structure, ht = "400px"){
nodes.uniq <- unique(c(structure$arcs[,1], structure$arcs[,2]))
nodes <- data.frame(id = nodes.uniq,
label = nodes.uniq,
color = "darkturquoise",
shadow = TRUE)
edges <- data.frame(from = structure$arcs[,1],
to = structure$arcs[,2],
arrows = "to",
smooth = TRUE,
shadow = TRUE,
color = "black")
return(visNetwork(nodes, edges, height = ht, width = "100%"))
}
fit = bn.fit(e, data, method = "mle", debug = TRUE)
e = empty.graph(nodi)
class(e)
e
arc.set = matrix(c("accel1_module","sitting"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set
arcs(e) = arc.set
fit = bn.fit(e, data, method = "mle", debug = TRUE)
plot.network(e)
e = empty.graph(nodi)
class(e)
e
arc.set = matrix(c("accel_mean", "sitting"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set
arcs(e) = arc.set
e
data <- read.csv(file="../measure_for_r.csv", header=TRUE, sep=";")
data$sitting <- factor(data$sitting)
data$sittingdown <- factor(data$sittingdown)
data$walking <- factor(data$walking)
data$standing <- factor(data$standing)
data$standingup <- factor(data$standingup)
plot.network(e)
plot.network <- function(structure, ht = "400px"){
nodes.uniq <- unique(c(structure$arcs[,1], structure$arcs[,2]))
nodes <- data.frame(id = nodes.uniq,
label = nodes.uniq,
color = "darkturquoise",
shadow = TRUE)
edges <- data.frame(from = structure$arcs[,1],
to = structure$arcs[,2],
arrows = "to",
smooth = TRUE,
shadow = TRUE,
color = "black")
return(visNetwork(nodes, edges, height = ht, width = "100%"))
}
fit = bn.fit(e, data, method = "mle", debug = TRUE)
bn.net(fit, debug = FALSE)
structure <- hc(data, score = "bic-cg")
structure <- hc(data, score = "bic-cg")
fit = bn.fit(structure, data)
plot.network(structure)
structure <- tabu(data, score = "bic-cg")
fit = bn.fit(structure, data)
plot.network(structure)
arc.set = matrix(c("accel1_module","sitting",
"accel_mean", "sitting",
"roll2_var","sitting",
"pitch4_var","sittingdown",
"roll2_var","standing",
"roll1_var","standing",
"pitch4_var","standingup",
"pitch2_var","standingup",
"roll3_var","standingup",
"pitch3_var","standingup",
"pitch3_var","walking",
"accel_mean","walking",
"pitch1_var","walking"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
structure <- hc(data, score = "bic-cg", whitelist=arc.set )
library(bnlearn)
library(visNetwork)
structure <- hc(data, score = "bic-cg", whitelist=arc.set )
nodi <- c("roll1_var","pitch1_var","accel1_module","roll2_var","pitch2_var","accel2_module","roll3_var","pitch3_var","accel3_module","roll4_var","pitch4_var","accel4_module","accel_mean","accel_std","sitting","sittingdown","walking","standing","standingup")
e = empty.graph(nodi)
class(e)
e
library(bnlearn)
library(visNetwork)
nodi <- c("roll1_var","pitch1_var","accel1_module","roll2_var","pitch2_var","accel2_module","roll3_var","pitch3_var","accel3_module","roll4_var","pitch4_var","accel4_module","accel_mean","accel_std","sitting","sittingdown","walking","standing","standingup")
e = empty.graph(nodi)
class(e)
e
arc.set = matrix(c("accel1_module","sitting",
"accel_mean", "sitting",
"roll2_var","sitting",
"pitch4_var","sittingdown",
"roll2_var","standing",
"roll1_var","standing",
"pitch4_var","standingup",
"pitch2_var","standingup",
"roll3_var","standingup",
"pitch3_var","standingup",
"pitch3_var","walking",
"accel_mean","walking",
"pitch1_var","walking"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set = matrix(c("accel_mean", "sitting"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set
arcs(e) = arc.set
e
#data <- read.csv(file="../measure_for_r.csv", header=TRUE, sep=";")
data <- read.csv(file="../data/discrete_dataset.csv", header=TRUE, sep=";")
data$sitting <- factor(data$sitting)
data$sittingdown <- factor(data$sittingdown)
View(data)
#data <- read.csv(file="../measure_for_r.csv", header=TRUE, sep=";")
data <- read.csv(file="../data/discrete_dataset_target_separato.csv", header=TRUE, sep=";")
#data <- read.csv(file="../measure_for_r.csv", header=TRUE, sep=";")
data <- read.csv(file="../data/discrete_dataset.csv", header=TRUE, sep=";")
data$sitting <- factor(data$sitting)
data$sittingdown <- factor(data$sittingdown)
data$walking <- factor(data$walking)
data$standing <- factor(data$standing)
data$standingup <- factor(data$standingup)
plot.network(e)
plot.network <- function(structure, ht = "400px"){
nodes.uniq <- unique(c(structure$arcs[,1], structure$arcs[,2]))
nodes <- data.frame(id = nodes.uniq,
label = nodes.uniq,
color = "darkturquoise",
shadow = TRUE)
edges <- data.frame(from = structure$arcs[,1],
to = structure$arcs[,2],
arrows = "to",
smooth = TRUE,
shadow = TRUE,
color = "black")
return(visNetwork(nodes, edges, height = ht, width = "100%"))
}
plot.network(e)
nodi <- c("roll1_var","pitch1_var","accel1_module","roll2_var","pitch2_var","accel2_module","roll3_var","pitch3_var","accel3_module","roll4_var","pitch4_var","accel4_module","accel_mean","accel_std","sitting","sittingdown","walking","standing","standingup")
e = empty.graph(nodi)
class(e)
e
arc.set = matrix(c("accel1_module","sitting",
"accel_mean", "sitting",
"roll2_var","sitting",
"pitch4_var","sittingdown",
"roll2_var","standing",
"roll1_var","standing",
"pitch4_var","standingup",
"pitch2_var","standingup",
"roll3_var","standingup",
"pitch3_var","standingup",
"pitch3_var","walking",
"accel_mean","walking",
"pitch1_var","walking"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set = matrix(c("accel_mean", "sitting"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set
arcs(e) = arc.set
e
arc.set = matrix(c("accel1_module","sitting",
"accel_mean", "sitting",
"roll2_var","sitting",
"pitch4_var","sittingdown",
"roll2_var","standing",
"roll1_var","standing",
"pitch4_var","standingup",
"pitch2_var","standingup",
"roll3_var","standingup",
"pitch3_var","standingup",
"pitch3_var","walking",
"accel_mean","walking",
"pitch1_var","walking"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set
arcs(e) = arc.set
e
#data <- read.csv(file="../measure_for_r.csv", header=TRUE, sep=";")
data <- read.csv(file="../data/discrete_dataset.csv", header=TRUE, sep=";")
data$sitting <- factor(data$sitting)
data$sittingdown <- factor(data$sittingdown)
data$walking <- factor(data$walking)
data$standing <- factor(data$standing)
data$standingup <- factor(data$standingup)
plot.network(e)
plot.network <- function(structure, ht = "400px"){
nodes.uniq <- unique(c(structure$arcs[,1], structure$arcs[,2]))
nodes <- data.frame(id = nodes.uniq,
label = nodes.uniq,
color = "darkturquoise",
shadow = TRUE)
edges <- data.frame(from = structure$arcs[,1],
to = structure$arcs[,2],
arrows = "to",
smooth = TRUE,
shadow = TRUE,
color = "black")
return(visNetwork(nodes, edges, height = ht, width = "100%"))
}
fit = bn.fit(e, data, method = "mle", debug = TRUE)
structure <- hc(data, score = "bic-cg", whitelist=arc.set )
fit = bn.fit(structure, data)
plot.network(structure)
structure <- hc(data, score = "bic-cg", whitelist=arc.set )
View(data)
fit = bn.fit(e, data, method = "mle", debug = TRUE)
fit = bn.fit(e, data, method = "bayes", debug = TRUE)
View(data)
#_-------
nodi <- c("roll1_var_disc","pitch1_var_disc","accel1_module_disc","roll2_var_disc","pitch2_var_disc","accel2_module_disc","roll3_var_disc","pitch3_var_disc","accel3_module_disc","roll4_var_disc","pitch4_var_disc","accel4_module_disc","accel_mean_disc","accel_std_disc","sitting","sittingdown","walking","standing","standingup")
e = empty.graph(nodi)
class(e)
e
arc.set = matrix(c("accel1_module_disc","sitting_disc",
"accel_mean_disc", "sitting_disc",
"roll2_var_disc","sitting_disc",
"pitch4_var_disc","sittingdown_disc",
"roll2_var_disc","standing_disc",
"roll1_var_disc","standing_disc",
"pitch4_var_disc","standingup_disc",
"pitch2_var_disc","standingup_disc",
"roll3_var_disc","standingup_disc",
"pitch3_var_disc","standingup",
"pitch3_var_disc","walking",
"accel_mean_disc","walking",
"pitch1_var_disc","walking"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set
arcs(e) = arc.set
#_-------
nodi <- c("roll1_var_disc","pitch1_var_disc","accel1_module_disc","roll2_var_disc","pitch2_var_disc","accel2_module_disc","roll3_var_disc","pitch3_var_disc","accel3_module_disc","roll4_var_disc","pitch4_var_disc","accel4_module_disc","accel_mean_disc","accel_std_disc","sitting","sittingdown","walking","standing","standingup")
e = empty.graph(nodi)
class(e)
e
arc.set = matrix(c("accel1_module_disc","sitting",
"accel_mean_disc", "sitting",
"roll2_var_disc","sitting",
"pitch4_var_disc","sittingdown",
"roll2_var_disc","standing",
"roll1_var_disc","standing",
"pitch4_var_disc","standingup",
"pitch2_var_disc","standingup",
"roll3_var_disc","standingup",
"pitch3_var_disc","standingup",
"pitch3_var_disc","walking",
"accel_mean_disc","walking",
"pitch1_var_disc","walking"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set
arcs(e) = arc.set
e
#data <- read.csv(file="../measure_for_r.csv", header=TRUE, sep=";")
data <- read.csv(file="../data/discrete_dataset.csv", header=TRUE, sep=";")
data$sitting <- factor(data$sitting)
data$sittingdown <- factor(data$sittingdown)
data$walking <- factor(data$walking)
data$standing <- factor(data$standing)
data$standingup <- factor(data$standingup)
plot.network(e)
plot.network <- function(structure, ht = "400px"){
nodes.uniq <- unique(c(structure$arcs[,1], structure$arcs[,2]))
nodes <- data.frame(id = nodes.uniq,
label = nodes.uniq,
color = "darkturquoise",
shadow = TRUE)
edges <- data.frame(from = structure$arcs[,1],
to = structure$arcs[,2],
arrows = "to",
smooth = TRUE,
shadow = TRUE,
color = "black")
return(visNetwork(nodes, edges, height = ht, width = "100%"))
}
fit = bn.fit(e, data, method = "mle", debug = TRUE)
data$accel1_module_disc
bn.net(fit, debug = FALSE)
fit = bn.fit(e, data, method = "mle", debug = TRUE)
data$accel1_module_disc <- factor(data$accel1_module_disc)
data$accel_mean_disc <- factor(data$accel_mean_disc)
data$roll2_var_disc <- factor(data$roll2_var_disc)
data$pitch4_var_disc <- factor(data$pitch4_var_disc)
data$roll1_var_disc <- factor(data$roll1_var_disc)
data$roll3_var_disc <- factor(data$roll3_var_disc)
data$pitch3_var_disc <- factor(data$pitch3_var_disc)
data$pitch1_var_disc <- factor(data$pitch1_var_disc)
plot.network(e)
plot.network <- function(structure, ht = "400px"){
nodes.uniq <- unique(c(structure$arcs[,1], structure$arcs[,2]))
nodes <- data.frame(id = nodes.uniq,
label = nodes.uniq,
color = "darkturquoise",
shadow = TRUE)
edges <- data.frame(from = structure$arcs[,1],
to = structure$arcs[,2],
arrows = "to",
smooth = TRUE,
shadow = TRUE,
color = "black")
return(visNetwork(nodes, edges, height = ht, width = "100%"))
}
fit = bn.fit(e, data, method = "mle", debug = TRUE)
data$accel2_module_disc <- factor(data$accel2_module_disc)
fit = bn.fit(e, data, method = "mle", debug = TRUE)
data$accel3_module_disc <- factor(data$accel3_module_disc)
fit = bn.fit(e, data, method = "mle", debug = TRUE)
data$accel4_module_disc <- factor(data$accel4_module_disc)
fit = bn.fit(e, data, method = "mle", debug = TRUE)
data$pitch2_var_disc <- factor(data$pitch2_var_disc)
fit = bn.fit(e, data, method = "mle", debug = TRUE)
data$roll4_var_disc <- factor(data$roll4_var_disc)
fit = bn.fit(e, data, method = "mle", debug = TRUE)
#_-------
nodi <- c("roll1_var_disc","pitch1_var_disc","accel1_module_disc","roll2_var_disc","pitch2_var_disc","roll3_var_disc","pitch3_var_disc","pitch4_var_disc","accel_mean_disc","sitting","sittingdown","walking","standing","standingup")
e = empty.graph(nodi)
class(e)
e
arc.set = matrix(c("accel1_module_disc","sitting",
"accel_mean_disc", "sitting",
"roll2_var_disc","sitting",
"pitch4_var_disc","sittingdown",
"roll2_var_disc","standing",
"roll1_var_disc","standing",
"pitch4_var_disc","standingup",
"pitch2_var_disc","standingup",
"roll3_var_disc","standingup",
"pitch3_var_disc","standingup",
"pitch3_var_disc","walking",
"accel_mean_disc","walking",
"pitch1_var_disc","walking"),
ncol = 2, byrow = TRUE,
dimnames = list(NULL, c("from", "to")))
arc.set
arcs(e) = arc.set
e
#data <- read.csv(file="../measure_for_r.csv", header=TRUE, sep=";")
data <- read.csv(file="../data/discrete_dataset.csv", header=TRUE, sep=";")
data$sitting <- factor(data$sitting)
data$sittingdown <- factor(data$sittingdown)
data$walking <- factor(data$walking)
data$standing <- factor(data$standing)
data$standingup <- factor(data$standingup)
data$accel1_module_disc <- factor(data$accel1_module_disc)
data$accel2_module_disc <- factor(data$accel2_module_disc)
data$accel3_module_disc <- factor(data$accel3_module_disc)
data$accel4_module_disc <- factor(data$accel4_module_disc)
data$accel_mean_disc <- factor(data$accel_mean_disc)
data$roll2_var_disc <- factor(data$roll2_var_disc)
data$pitch4_var_disc <- factor(data$pitch4_var_disc)
data$roll1_var_disc <- factor(data$roll1_var_disc)
data$roll3_var_disc <- factor(data$roll3_var_disc)
data$roll4_var_disc <- factor(data$roll4_var_disc)
data$pitch3_var_disc <- factor(data$pitch3_var_disc)
data$pitch2_var_disc <- factor(data$pitch2_var_disc)
data$pitch1_var_disc <- factor(data$pitch1_var_disc)
plot.network(e)
plot.network <- function(structure, ht = "400px"){
nodes.uniq <- unique(c(structure$arcs[,1], structure$arcs[,2]))
nodes <- data.frame(id = nodes.uniq,
label = nodes.uniq,
color = "darkturquoise",
shadow = TRUE)
edges <- data.frame(from = structure$arcs[,1],
to = structure$arcs[,2],
arrows = "to",
smooth = TRUE,
shadow = TRUE,
color = "black")
return(visNetwork(nodes, edges, height = ht, width = "100%"))
}
fit = bn.fit(e, data, method = "mle", debug = TRUE)
data_fit <- subset(data, select = nodi)
data_fit <- subset(data, select = nodi)
data_fit <- subset(data, select = c("roll1_var_disc","pitch1_var_disc","accel1_module_disc","roll2_var_disc","pitch2_var_disc","roll3_var_disc","pitch3_var_disc","pitch4_var_disc","accel_mean_disc","sitting","sittingdown","walking","standing","standingup"))
data_fit <- data[nodi]
data_fit <- data[nodi]
data_fit <- data["pitch1_var_disc"]
data_fit
data_fit <- data["pitch1_var_disc", "pitch2_var_disc"]
data_fit
data_fit <- data[c("pitch1_var_disc", "pitch2_var_disc")]
data_fit
data_fit <- data[c("roll1_var_disc","pitch1_var_disc","accel1_module_disc","roll2_var_disc","pitch2_var_disc","roll3_var_disc","pitch3_var_disc","pitch4_var_disc","accel_mean_disc","sitting","sittingdown","walking","standing","standingup"))]
data_fit <- data[c("roll1_var_disc","pitch1_var_disc","accel1_module_disc","roll2_var_disc","pitch2_var_disc","roll3_var_disc","pitch3_var_disc","pitch4_var_disc","accel_mean_disc","sitting","sittingdown","walking","standing","standingup")]
View(data)
data_fit <- data[c("roll1_var_disc","pitch1_var_disc","accel1_module_disc","roll2_var_disc")]
data_fit <- data[c("roll1_var_disc","pitch1_var_disc","accel1_module_disc","roll2_var_disc","pitch2_var_disc")]
data_fit <- data[c("roll1_var_disc","pitch1_var_disc","accel1_module_disc","roll2_var_disc","pitch2_var_disc","roll3_var_disc")]
data_fit <- data[c("roll1_var_disc","pitch1_var_disc","accel1_module_disc","roll2_var_disc","pitch2_var_disc","roll3_var_disc","pitch3_var_disc")]
data_fit <- data[c("roll1_var_disc","pitch1_var_disc","accel1_module_disc","roll2_var_disc","pitch2_var_disc","roll3_var_disc","pitch3_var_disc","pitch4_var_disc")]
data_fit <- data[c("roll1_var_disc","pitch1_var_disc","accel1_module_disc","roll2_var_disc","pitch2_var_disc","roll3_var_disc","pitch3_var_disc","pitch4_var_disc","accel_mean_disc")]
data$accel_mean
